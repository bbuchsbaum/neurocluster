<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Single Run SLiCE-MSF Segmentation — slice_msf_single • neurocluster</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Single Run SLiCE-MSF Segmentation — slice_msf_single"><meta name="description" content="Lower-level function that performs a single run of SLiCE-MSF segmentation without
consensus fusion. This function is useful for testing parameters or when you need
direct access to the DCT sketch and reliability weights. Most users should use
slice_msf instead for better stability through consensus."><meta property="og:description" content="Lower-level function that performs a single run of SLiCE-MSF segmentation without
consensus fusion. This function is useful for testing parameters or when you need
direct access to the DCT sketch and reliability weights. Most users should use
slice_msf instead for better stability through consensus."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neurocluster</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/01-getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/02-compare-methods.html">Compare Methods</a></li>
    <li><a class="dropdown-item" href="../articles/03-end-to-end-export.html">End-to-End Export</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>How-tos</h6></li>
    <li><a class="dropdown-item" href="../articles/10-choose-parameters.html">Choose Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/11-speed-parallel.html">Speed &amp; Parallel</a></li>
    <li><a class="dropdown-item" href="../articles/12-visualize-export.html">Visualize &amp; Export</a></li>
    <li><a class="dropdown-item" href="../articles/13-consensus-stitch.html">Consensus &amp; Stitching</a></li>
    <li><a class="dropdown-item" href="../articles/14-validate-compare.html">Validate &amp; Compare</a></li>
    <li><a class="dropdown-item" href="../articles/15-legacy-apis.html">Legacy APIs</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Explanations</h6></li>
    <li><a class="dropdown-item" href="../articles/20-spatially-constrained-clustering.html">Spatially Constrained Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/21-method-deep-dives.html">Method Deep Dives</a></li>
    <li><a class="dropdown-item" href="../articles/22-performance-memory.html">Performance &amp; Memory</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Reference Maps</h6></li>
    <li><a class="dropdown-item" href="../articles/30-api-overview.html">API Overview</a></li>
    <li><a class="dropdown-item" href="../articles/31-objects-results.html">Objects &amp; Results</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Single Run SLiCE-MSF Segmentation</h1>

      <div class="d-none name"><code>slice_msf_single.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Lower-level function that performs a single run of SLiCE-MSF segmentation without
consensus fusion. This function is useful for testing parameters or when you need
direct access to the DCT sketch and reliability weights. Most users should use
<code>slice_msf</code> instead for better stability through consensus.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">slice_msf_single</span><span class="op">(</span></span>
<span>  <span class="va">vec</span>,</span>
<span>  <span class="va">mask</span>,</span>
<span>  r <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">0.32</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">80</span>,</span>
<span>  nbhd <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  stitch_z <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  theta_link <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  min_contact <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  z_mult <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vec">vec<a class="anchor" aria-label="anchor" href="#arg-vec"></a></dt>
<dd><p>A <code>NeuroVec</code> instance supplying the time series data.</p></dd>


<dt id="arg-mask">mask<a class="anchor" aria-label="anchor" href="#arg-mask"></a></dt>
<dd><p>A <code>NeuroVol</code> mask defining the voxels to include.</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>DCT sketch rank (number of basis functions). Higher values preserve more
temporal detail but increase computation. Range: 4-20. Default is 12.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Scale parameter for Felzenszwalb-Huttenlocher segmentation (0-2). Controls
the trade-off between under- and over-segmentation. Smaller values (0.1-0.3) create
more clusters, larger values (0.5-1.0) create fewer, larger clusters. Default is 0.32.</p></dd>


<dt id="arg-min-size">min_size<a class="anchor" aria-label="anchor" href="#arg-min-size"></a></dt>
<dd><p>Minimum cluster size in voxels. Clusters smaller than this are merged
with neighbors. Default is 80.</p></dd>


<dt id="arg-nbhd">nbhd<a class="anchor" aria-label="anchor" href="#arg-nbhd"></a></dt>
<dd><p>Neighborhood connectivity for within-slice edges (4 or 8). Note that 6 is
automatically mapped to 8. Default is 8.</p></dd>


<dt id="arg-stitch-z">stitch_z<a class="anchor" aria-label="anchor" href="#arg-stitch-z"></a></dt>
<dd><p>Enable cross-slice stitching to create 3D clusters. When FALSE, each
slice is treated independently. Default is TRUE.</p></dd>


<dt id="arg-theta-link">theta_link<a class="anchor" aria-label="anchor" href="#arg-theta-link"></a></dt>
<dd><p>Centroid correlation threshold for z-stitching (0-1). Lower values
allow more aggressive merging across slices. Only used if stitch_z=TRUE. Default is 0.85.</p></dd>


<dt id="arg-min-contact">min_contact<a class="anchor" aria-label="anchor" href="#arg-min-contact"></a></dt>
<dd><p>Minimum number of vertically adjacent voxels required to consider
stitching two clusters. Only used if stitch_z=TRUE. Default is 1.</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Reliability weighting exponent based on split-half correlations. Higher
values give more weight to reliable voxels. Default is 1.5.</p></dd>


<dt id="arg-z-mult">z_mult<a class="anchor" aria-label="anchor" href="#arg-z-mult"></a></dt>
<dd><p>Z-smoothing factor (0-1). Values &gt; 0 blend slice sketches prior to
clustering to reduce boundary artifacts. Default is 0.0.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p><dl><dt>labels</dt>
<dd><p>Integer vector of cluster labels for each voxel</p></dd>

<dt>weights</dt>
<dd><p>Numeric vector of reliability weights for each voxel</p></dd>

<dt>sketch</dt>
<dd><p>Matrix of DCT coefficients (r × n_voxels)</p></dd>

<dt>params</dt>
<dd><p>List of parameters used in the segmentation</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function exposes the core SLiCE-MSF algorithm without consensus fusion. The
returned sketch matrix contains the DCT coefficients that summarize each voxel's
time series, and the weights indicate the reliability of each voxel based on
split-half correlations. These can be useful for diagnostic purposes or custom
post-processing.</p>
<p>The k parameter is particularly important: it directly controls the scale of
segmentation. For typical fMRI data, values between 0.2-0.5 work well. Lower
values are needed for fine-grained parcellation, while higher values produce
coarser segmentation.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

