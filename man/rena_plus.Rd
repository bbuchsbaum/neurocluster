% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rena_plus.R
\name{rena_plus}
\alias{rena_plus}
\title{ReNA++: Edge-aware Reciprocal Multi-Level ReNA with Ward refinement}
\usage{
rena_plus(
  bvec,
  mask,
  K = 100,
  r = 2,
  lambda = 1,
  grad_img = NULL,
  connectivity = 26,
  max_iterations = 50,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{bvec}{A \code{NeuroVec} providing voxel time-series.}

\item{mask}{A \code{NeuroVol} mask; non-zero voxels are included.}

\item{K}{Target number of clusters.}

\item{r}{Over-clustering factor; coarsening stops at K' = ceiling(r * K). Default 2.}

\item{lambda}{Gradient penalty strength (>=0). 0 disables edge weighting.}

\item{grad_img}{Optional numeric vector: gradient/intensity per voxel. Either length = prod(dim(mask))
(in which case values are subset by mask) or length = number of masked voxels. If NULL, no gradient.}

\item{connectivity}{Neighborhood connectivity (6, 18, or 26). Default 26.}

\item{max_iterations}{Max iterations for coarsening stage.}

\item{verbose}{Logical for progress messages.}

\item{...}{Reserved for future options.}
}
\value{
A \code{cluster4d_result} with additional class \code{rena_plus_cluster_result}.
}
\description{
Two-stage pipeline:
\enumerate{
\item Edge-aware reciprocal-nearest-neighbor ReNA coarsening to K' = r * K super-voxels.
\item Spatially-constrained Ward refinement on the super-graph to reach exactly K clusters.
}
}
