% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gradient.R
\name{compute_functional_gradient}
\alias{compute_functional_gradient}
\title{Compute Functional Gradient from Feature Matrix}
\usage{
compute_functional_gradient(feature_mat, coords, k_neighbors = 26)
}
\arguments{
\item{feature_mat}{Numeric matrix (N x M) of features (voxels x dimensions).}

\item{coords}{Numeric matrix (N x 3) of spatial coordinates.}

\item{k_neighbors}{Integer; number of nearest spatial neighbors to use.
Default: 26.}
}
\value{
Numeric vector of length N containing gradient values for each voxel.
}
\description{
Calculates the functional gradient for each voxel as the average dissimilarity
to its spatial neighbors in feature space. Low gradient values indicate stable,
homogeneous regions (good seed locations); high values indicate boundaries.
}
\details{
For each voxel i, the functional gradient is:
\deqn{grad(i) = \frac{1}{k} \sum_{j \in N_k(i)} (1 - f_i \cdot f_j)}

where \eqn{N_k(i)} are the k nearest spatial neighbors and \eqn{f_i \cdot f_j}
is the dot product (cosine similarity for unit-length vectors).
}
\examples{
\dontrun{
features <- matrix(rnorm(500 * 15), 500, 15)
features <- t(apply(features, 1, function(x) x / sqrt(sum(x^2))))
coords <- matrix(rnorm(500 * 3), 500, 3)

grad <- compute_functional_gradient(features, coords, k_neighbors = 26)
hist(grad, breaks = 50, main = "Functional Gradient Distribution")
}

}
