% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/supervoxels.R
\name{supervoxels}
\alias{supervoxels}
\title{Supervoxel Clustering (3D volumes)}
\usage{
supervoxels(
  bvec,
  mask,
  K = 500,
  sigma1 = 1,
  sigma2 = 2.5,
  iterations = 50,
  connectivity = 27,
  use_medoid = FALSE,
  use_gradient = TRUE,
  alpha = 0.5
)
}
\arguments{
\item{bvec}{A \code{\linkS4class{NeuroVec}} instance supplying the data to cluster.}

\item{mask}{A \code{\linkS4class{NeuroVol}} mask defining the voxels to include. If numeric, nonzero = included.}

\item{K}{The number of clusters to find (default 500).}

\item{sigma1}{The bandwidth of the heat kernel for the data vectors.}

\item{sigma2}{The bandwidth of the heat kernel for the coordinate vectors.}

\item{iterations}{The maximum number of cluster iterations.}

\item{connectivity}{The number of nearest neighbors defining the neighborhood.}

\item{use_medoid}{Logical; whether to use medoids rather than means for cluster centers.}

\item{use_gradient}{Logical; use the image gradient to initialize clusters if possible.}

\item{alpha}{The relative weighting of data similarity vs spatial similarity;
\code{alpha=1} = all data weighting, \code{alpha=0} = purely spatial weighting.}
}
\value{
A \code{list} (of class \code{cluster_result}) with elements:
  \item{clusvol}{\code{ClusteredNeuroVol} containing the final clustering.}
  \item{cluster}{Integer vector of cluster assignments for each voxel.}
  \item{centers}{Matrix of cluster centers in feature space.}
  \item{coord_centers}{Matrix of cluster spatial centroids.}
}
\description{
Cluster a \code{NeuroVec} instance into a set of spatially constrained clusters.
}
\details{
The algorithm:
\enumerate{
  \item Scale input data (\code{bvec}) so each feature dimension is centered and scaled.
  \item If \code{use_gradient = TRUE}, initialize cluster seeds using gradient-based heuristics.
  \item Run an iterative, spatially-constrained clustering that updates voxel assignments based on
        both feature similarity (bandwidth \code{sigma1}) and spatial proximity (bandwidth \code{sigma2}),
        weighted by \code{alpha}.
  \item Return the final clusters, plus the feature-space and coordinate-space centers.
}
}
\examples{
mask <- NeuroVol(array(1, c(20,20,20)), NeuroSpace(c(20,20,20)))
bvec <- replicate(10,
                  NeuroVol(array(runif(20*20*20), c(20,20,20)),
                           NeuroSpace(c(20,20,20))),
                  simplify=FALSE)
bvec <- do.call(concat, bvec)
cres1 <- supervoxels(bvec, mask, K=100, sigma1=1, sigma2=3)

}
