% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_utils.R
\name{randomize_cluster_ids}
\alias{randomize_cluster_ids}
\title{Randomize Cluster IDs}
\usage{
randomize_cluster_ids(cluster_result, seed = NULL)
}
\arguments{
\item{cluster_result}{A clustering result object (e.g., from cluster4d,
supervoxels_flash3d, slice_msf, etc.) containing at minimum:
\itemize{
\item \code{cluster}: vector of cluster assignments
\item \code{clusvol}: ClusteredNeuroVol object
\item Optionally: \code{centers}, \code{coord_centers}, etc.
}}

\item{seed}{Optional random seed for reproducibility. If NULL, uses R's
current random state. Default is NULL.}
}
\value{
A modified cluster_result object with randomized cluster IDs. All
components (cluster vector, clusvol, centers, coord_centers, etc.) are
updated consistently.
}
\description{
Randomly permute cluster IDs to break any spatial ordering. This is useful
when visualizing clusters with continuous color scales, as spatially-ordered
cluster IDs create artificial gradients that can be misleading.
}
\details{
Many clustering algorithms assign cluster IDs sequentially as clusters are
encountered during processing. When voxels are processed in memory order
(which is typically z-major in 3D arrays), this creates systematic ordering
where cluster ID correlates with z-position (inferior to superior in brain
imaging).

This spatial ordering creates two problems:
\enumerate{
\item \strong{Visualization artifacts}: When viewed with continuous color scales
(e.g., viridis, rainbow), ordered cluster IDs create artificial gradients
that suggest spatial structure where none exists. Randomized IDs show
each cluster as a distinct color patch.
\item \strong{Interpretation bias}: Ordered IDs may mislead users into thinking
cluster numbering has anatomical significance (e.g., "cluster 1 is always
inferior, cluster 100 is always superior").
}

This function breaks the ordering by randomly permuting cluster IDs while
maintaining all cluster memberships and properties.
}
\examples{
\dontrun{
# Standard workflow with ordered IDs
result <- cluster4d(vec, mask, K = 100, method = "flash3d")

# Randomize for better visualization
result_random <- randomize_cluster_ids(result, seed = 42)

# Compare visualizations
# Ordered IDs show gradient from inferior to superior
plot(result$clusvol)

# Randomized IDs show distinct color patches
plot(result_random$clusvol)

# Works with any clustering method
result_msf <- cluster4d(vec, mask, K = 100, method = "slice_msf")
result_msf_random <- randomize_cluster_ids(result_msf)
}

}
