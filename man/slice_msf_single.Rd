% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/slice_cluster.R
\name{slice_msf_single}
\alias{slice_msf_single}
\title{Single Run SLiCE-MSF Segmentation}
\usage{
slice_msf_single(
  vec,
  mask,
  r = 12,
  k = 0.32,
  min_size = 80,
  nbhd = 8,
  stitch_z = TRUE,
  theta_link = 0.85,
  min_contact = 1,
  gamma = 1.5
)
}
\arguments{
\item{vec}{A \code{NeuroVec} instance supplying the time series data.}

\item{mask}{A \code{NeuroVol} mask defining the voxels to include.}

\item{r}{DCT sketch rank (number of basis functions). Higher values preserve more
temporal detail but increase computation. Range: 4-20. Default is 12.}

\item{k}{Scale parameter for Felzenszwalb-Huttenlocher segmentation (0-2). Controls
the trade-off between under- and over-segmentation. Smaller values (0.1-0.3) create
more clusters, larger values (0.5-1.0) create fewer, larger clusters. Default is 0.32.}

\item{min_size}{Minimum cluster size in voxels. Clusters smaller than this are merged
with neighbors. Default is 80.}

\item{nbhd}{Neighborhood connectivity for within-slice edges (4 or 8). Note that 6 is
automatically mapped to 8. Default is 8.}

\item{stitch_z}{Enable cross-slice stitching to create 3D clusters. When FALSE, each
slice is treated independently. Default is TRUE.}

\item{theta_link}{Centroid correlation threshold for z-stitching (0-1). Lower values
allow more aggressive merging across slices. Only used if stitch_z=TRUE. Default is 0.85.}

\item{min_contact}{Minimum number of vertically adjacent voxels required to consider
stitching two clusters. Only used if stitch_z=TRUE. Default is 1.}

\item{gamma}{Reliability weighting exponent based on split-half correlations. Higher
values give more weight to reliable voxels. Default is 1.5.}
}
\value{
A list with the following components:
\describe{
  \item{labels}{Integer vector of cluster labels for each voxel}
  \item{weights}{Numeric vector of reliability weights for each voxel}
  \item{sketch}{Matrix of DCT coefficients (r Ã— n_voxels)}
  \item{params}{List of parameters used in the segmentation}
}
}
\description{
Lower-level function that performs a single run of SLiCE-MSF segmentation without
consensus fusion. This function is useful for testing parameters or when you need
direct access to the DCT sketch and reliability weights. Most users should use 
\code{slice_msf} instead for better stability through consensus.
}
\details{
This function exposes the core SLiCE-MSF algorithm without consensus fusion. The
returned sketch matrix contains the DCT coefficients that summarize each voxel's
time series, and the weights indicate the reliability of each voxel based on
split-half correlations. These can be useful for diagnostic purposes or custom
post-processing.

The k parameter is particularly important: it directly controls the scale of
segmentation. For typical fMRI data, values between 0.2-0.5 work well. Lower
values are needed for fine-grained parcellation, while higher values produce
coarser segmentation.
}
