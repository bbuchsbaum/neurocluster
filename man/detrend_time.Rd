% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{detrend_time}
\alias{detrend_time}
\title{Detrend Voxel Timeseries}
\usage{
detrend_time(
  vec,
  mask = NULL,
  method = c("linear", "poly", "dct"),
  degree = 2,
  n_basis = 4
)
}
\arguments{
\item{vec}{A \code{NeuroVec} object (4D neuroimaging data)}

\item{mask}{Optional \code{NeuroVol} mask. If NULL, uses all non-zero voxels.}

\item{method}{Detrending method: "linear" (default), "poly", or "dct"}

\item{degree}{For method="poly", the polynomial degree (1=linear, 2=quadratic, etc.)}

\item{n_basis}{For method="dct", number of DCT basis functions to remove.
Higher values = more aggressive high-pass filtering.}
}
\value{
A \code{NeuroVec} with trend removed from each voxel
}
\description{
Fast removal of trends from each voxel's timeseries in 4D neuroimaging data.
Supports linear, polynomial, and DCT (discrete cosine transform) detrending.
}
\details{
Three detrending methods are available:

\strong{Linear (method="linear"):}
Fastest option. Removes linear drift by fitting y = a + b*t.

\strong{Polynomial (method="poly"):}
Removes polynomial trend up to specified degree. degree=1 is linear,
degree=2 adds quadratic, etc. Uses orthonormalized basis for stability.

\strong{DCT (method="dct"):}
Removes low-frequency components using discrete cosine transform basis.
This is a standard high-pass filter for fMRI data. The n_basis parameter
controls the cutoff:
\itemize{
\item n_basis=1: mean removal only
\item n_basis=2: approximately linear detrend
\item n_basis=4-6: typical for fMRI (removes ~0.01 Hz drift for TR=2s)
}

All methods use fast C++ parallel implementation via RcppParallel.
}
\examples{
\dontrun{
vec <- neuroim2::read_vec("functional.nii.gz")

# Linear detrend (fastest)
vec_lin <- detrend_time(vec)

# Quadratic detrend
vec_quad <- detrend_time(vec, method = "poly", degree = 2)

# DCT high-pass filter (common for fMRI)
vec_dct <- detrend_time(vec, method = "dct", n_basis = 5)
}

}
